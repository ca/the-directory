<!DOCTYPE html>
<html lang="en">
    <head>
        {{>head}}
        <style type="text/css">
            input {
                padding-left: 0px !important;
            }

            .input-label {
                padding-top: 12px !important;
                font-weight: 600;
                color: #333;
            }

            .detail {
                font-weight: 200;
                font-size: 14px;
            }
        </style>
    </head>

    <body>
        <div id="header-fix" class="header fixed-top">        
            {{>nav}}
        </div>

        <!-- Page Inner -->
        <section class="lis-bg-light pb-5">
            <div class="container pt-5">
                <div class="row wow fadeInUp">
                    <div class="col-12 col-sm-6">
                        <div class="page-title">
                            <h2>Manage Your Profile</h2>
                            <p class="mb-0">
                                Update your profile information, images and manage your listings.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!--End Page Inner -->

        <!-- Pricing -->
        <section>
            <div class="container">
                <div class="row">

                    <div class="col-12 col-lg-8 mb-5 mb-lg-0">

                        <div class="card lis-brd-light wow fadeInUp" style="visibility: visible; animation-name: fadeInUp;">
                            <div class="card-body p-0">
                                <!-- User Images -->
                                <div class="row p-4">
                                    <div class="col-12 col-sm-12 mb-3">
                                        <h6 class="lis-font-weight-500">
                                            <i class="fa fa-file-image-o pr-2 lis-f-14"></i> Images
                                        </h6>

                                    </div>
                                    <div class="col-12 col-sm-12">
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-3 col-form-label">Primary Image</label>
                                            <div class="col-12 col-md-9">
                                                <a target="_blank" href="{{user.image}}">
                                                    <img id="profile-icon" style="margin-right:12px" src="{{user.image}}=s64-c" />
                                                </a>
                                                <button class="btn btn-info" id="btn-image-upload">Select Image</button>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-3 col-form-label">Cover Image</label>
                                            <div class="col-12 col-md-9">
                                                <a target="_blank" href="{{user.coverImage}}">
                                                    <img id="profile-cover-image" style="margin-right:12px" src="{{user.coverImage}}=s64-c" />
                                                </a>

                                                <button class="btn btn-info" id="btn-cover-image-upload">Select Cover Image</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr>
                                <!-- Basic User Information -->
                                <div class="row p-4">
                                    <div class="col-12 col-sm-12 mb-3">
                                        <h6 class="lis-font-weight-500">
                                            <i class="fa fa-align-left pr-2 lis-f-14"></i> Basic Info
                                        </h6>

                                    </div>
                                    <div class="col-12 col-sm-12">
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-2 col-form-label input-label">First Name</label>
                                            <div class="col-12 col-md-10">
                                                <input autocomplete="first name" id="profile-first-name" class="form-control border-top-0 border-left-0 border-right-0 rounded-0" type="text" placeholder="First Name" value="{{user.firstName}}">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-2 col-form-label input-label">Last Name</label>
                                            <div class="col-12 col-md-10">
                                                <input id="profile-last-name" class="form-control border-top-0 border-left-0 border-right-0 rounded-0" type="text" placeholder="Last name" value="{{user.lastName}}" >
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-2 col-form-label input-label">Username</label>
                                            <div class="col-12 col-md-10">
                                                <input id="profile-username" class="form-control border-top-0 border-left-0 border-right-0 rounded-0" type="text" placeholder="Username" value="{{user.username}}" >
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-2 col-form-label input-label">Hourly Rate</label>
                                            <!-- <div></div> -->
                                            <label class="col-12 col-md-1 col-form-label input-label" style="text-align: right">$</label>
                                            <div class="col-12 col-md-9">
                                                <input autocomplete="hourly rate" id="profile-hourly-rate" class="form-control border-top-0 border-left-0 border-right-0 rounded-0" type="number" placeholder="Hourly Rate" value="{{user.hourlyRate}}">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-2 col-form-label input-label">City</label>
                                            <div class="col-12 col-md-10">
                                                <input id="profile-city" class="form-control border-top-0 border-left-0 border-right-0 rounded-0" type="text" placeholder="City" value="{{user.city}}" >
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-2 col-form-label input-label">State</label>
                                            <div class="col-12 col-md-10">
                                                <select id="profile-state" class="form-control border-top-0 border-left-0 border-right-0 rounded-0">
                                                    <option value="">Select State</option>
                                                    <option value="AL">AL</option>
                                                    <option value="AK">AK</option>
                                                    <option value="AR">AR</option>  
                                                    <option value="AZ">AZ</option>
                                                    <option value="CA">CA</option>
                                                    <option value="CO">CO</option>
                                                    <option value="CT">CT</option>
                                                    <option value="DC">DC</option>
                                                    <option value="DE">DE</option>
                                                    <option value="FL">FL</option>
                                                    <option value="GA">GA</option>
                                                    <option value="HI">HI</option>
                                                    <option value="IA">IA</option>  
                                                    <option value="ID">ID</option>
                                                    <option value="IL">IL</option>
                                                    <option value="IN">IN</option>
                                                    <option value="KS">KS</option>
                                                    <option value="KY">KY</option>
                                                    <option value="LA">LA</option>
                                                    <option value="MA">MA</option>
                                                    <option value="MD">MD</option>
                                                    <option value="ME">ME</option>
                                                    <option value="MI">MI</option>
                                                    <option value="MN">MN</option>
                                                    <option value="MO">MO</option>  
                                                    <option value="MS">MS</option>
                                                    <option value="MT">MT</option>
                                                    <option value="NC">NC</option>  
                                                    <option value="NE">NE</option>
                                                    <option value="NH">NH</option>
                                                    <option value="NJ">NJ</option>
                                                    <option value="NM">NM</option>          
                                                    <option value="NV">NV</option>
                                                    <option value="NY">NY</option>
                                                    <option value="ND">ND</option>
                                                    <option value="OH">OH</option>
                                                    <option value="OK">OK</option>
                                                    <option value="OR">OR</option>
                                                    <option value="PA">PA</option>
                                                    <option value="RI">RI</option>
                                                    <option value="SC">SC</option>
                                                    <option value="SD">SD</option>
                                                    <option value="TN">TN</option>
                                                    <option value="TX">TX</option>
                                                    <option value="UT">UT</option>
                                                    <option value="VT">VT</option>
                                                    <option value="VA">VA</option>
                                                    <option value="WA">WA</option>
                                                    <option value="WI">WI</option>  
                                                    <option value="WV">WV</option>
                                                    <option value="WY">WY</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="example-text-input" class="col-12 col-md-2 col-form-label input-label">Bio</label>
                                            <div class="col-12 col-md-10">
                                                <textarea id="profile-bio" style="background:#f9f9f9;border:none" class="form-control border-top-0 border-left-0 border-right-0 rounded-0" placeholder="Bio">{{user.bio}}</textarea>

                                                <input id="profile-id" type="hidden" value="{{user.id}}">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-12" style="text-align:right">
                                        <a id="profile-update-button" href="#" class="btn btn-primary btn-default mt-3">Update Profile</a>
                                    </div>
                                </div>
                                
                                <hr/>

                                <div class="row p-4">
                                    <div class="col-12 col-sm-12 mb-3">
                                        <h6 class="lis-font-weight-500"><i class="fa fa-link pr-2 lis-f-14"></i>  Industries </h6>
                                        <span>Select the industries which you would like to mentor in</span>
                                    </div>
                                    <div class="col-12 col-sm-12 social-information" id="industries">
                                        <div class="form-group row">
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Technology
                                                    <input type="checkbox" name="industries" value="technology">
                                                    <span class="checkmark"></span>
                                                </label>

                                            </div>
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Law
                                                    <input type="checkbox" name="industries" value="law">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Sports
                                                    <input type="checkbox" name="industries" value="sports">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Military
                                                    <input type="checkbox" name="industries" value="military">
                                                    <span class="checkmark"></span>
                                                </label>

                                            </div>
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Government
                                                    <input type="checkbox" name="industries" value="government">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Education
                                                    <input type="checkbox" name="industries" value="education">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Venture Capital
                                                    <input type="checkbox" name="industries" value="venture capital">
                                                    <span class="checkmark"></span>
                                                </label>

                                            </div>
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Business
                                                    <input type="checkbox" name="industries" value="business">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Public Relations
                                                    <input type="checkbox" name="industries" value="public relations">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Finance
                                                    <input type="checkbox" name="industries" value="finance">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                            <div class="col-12 col-md-4">
                                                <label class="custom-checkbox">Banking
                                                    <input type="checkbox" name="industries" value="banking">
                                                    <span class="checkmark"></span>
                                                </label>

                                            </div>
                                            <div class="col-12 col-md-4">

                                                <label class="custom-checkbox">Marketing
                                                    <input type="checkbox" name="industries" value="marketing">
                                                    <span class="checkmark"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-12" style="text-align:right">
                                        <a id="update-industries" href="#" class="btn btn-primary btn-default mt-3">Update Industries</a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- User Card / Preview -->
                    <div class="col-12 col-lg-4 mb-5 mb-lg-0">
                        <div class="card lis-brd-light text-center text-lg-left">
                            {{#user.coverImage}}
                            <a href="/profile/{{user.username}}">
                                <div style="max-height:140px" class="lis-grediant grediant-tb-light2 lis-relative modImage rounded-top">
                                    <img src="{{user.coverImage}}=s320" alt="" class="img-fluid rounded-top w-100">
                                </div>
                            </a>
                            {{/user.coverImage}}
                            <div class="card-body pt-0">
                                <div class="media d-block d-lg-flex lis-relative">
                                    {{#user.image}}
                                    <img src="{{user.image}}=s80-c" alt="" class="lis-mt-minus-15 img-fluid d-lg-flex mx-auto mr-lg-3 mb-4 mb-lg-0 border lis-border-width-2 rounded-circle border-white" width="80">
                                    {{/user.image}}
                                    <div class="media-body align-self-start mt-2">
                                        <h6 class="mb-0 lis-font-weight-600">
                                            <a href="/profile/{{user.username}}" style="text-transform:capitalize" class="lis-dark">{{user.firstName}} {{user.lastName}}</a>
                                        </h6>
                                        <small>@{{user.username}}</small>
                                    </div>
                                </div>
                                <hr />
                                <p class="detail">{{user.bio}}</p>
                                <ul class="list-unstyled my-4 lis-line-height-2">
                                    {{#user.phone}}
                                    <li><i class="fa fa-phone pr-2"></i> {{user.phone}}</li>
                                    {{/user.phone}}

                                    {{#user.address}}
                                    <li><i class="fa fa-map-o pr-2"></i> {{user.address}}</li>
                                    {{/user.address}}
                                </ul>
                                <div class="clearfix">
                                    <div class="float-none float-lg-left mb-3 mb-lg-0 mt-1">

                                        {{#user.industries}}
                                        <a href="{{.}}" class="text-white" data-toggle="tooltip" data-placement="bottom" title="{{.}}"><i class="icofont icofont-{{.}} px-2 lis-bg5 py-2 lis-rounded-circle-50 lis-f-14"></i></a>
                                        {{/user.industries}}

                                        <!-- <a href="#" class="lis-id-info lis-light p-2 lis-rounded-circle-50 lis-f-14">1 More...</a> -->
                                    </div>
                                    <div class="float-none float-lg-right mt-1">
                                        <a href="mailto:{{user.email}}" class="lis-light lis-f-14"><i class="fa fa-envelope-o lis-id-info  lis-rounded-circle-50 text-center"></i></a>
                                        <a href="#" class="lis-green-light text-white text-white p-2 lis-rounded-circle-50 lis-f-14 lis-line-height-2"><i class="fa fa-star"></i> 4.0</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        {{>footer}}
        {{>modals}}
        {{>imports}}

        <script type="text/javascript">
            $(function(){
                $('#profile-state option').each(function () {
                    if ( $(this).val() === "{{user.state}}") {
                        $(this).attr('selected', true);
                    }
                })

                var industries = "{{user.industries}}".split(',');
                $('#industries input').each(function () {
                    if (industries.indexOf($(this).val()) > -1) $(this).attr('checked', true);
                })

                var commitUpdates = function(updatedProfile, completion){
                    $.ajax({
                        url : '/auth/update',
                        type: 'POST',
                        data : updatedProfile,
                        success: function(response, textStatus, jqXHR){
                            if (response.confirmation != 'success'){
                                alert('Error: ' + response.message)
                                return
                            }

                            console.log(JSON.stringify(response))
                            alert('Profile Updated')
                            if (completion == null)
                                return

                            completion(response.data)
                        },
                        error: function (jqXHR, textStatus, err){
                            alert('Error: ' + err.message)
                        }
                    })
                }

                var turbo = Turbo({site_id: '5a39290f529e850014a19dd9'})
                $('#btn-image-upload').click(function(event){
                    event.preventDefault()
                    turbo.uploadFile(function(err, data){
                        if (err){
                            alert('Error:' + err.message)
                            return
                        }

                        if (data.confirmation != 'success'){
                            alert('Error: ' + data.message)
                            return
                        }

                        var updatedProfile = {
                            id: $('#profile-id').val(),
                            image: data.result.url
                        }

                        commitUpdates(updatedProfile, function(profile){
                            $('#profile-icon').attr('src', profile.image+'=s64-c')
                        })
                    })
                })

                $('#btn-cover-image-upload').click(function(event){
                    event.preventDefault()
                    console.log("ALERT COVER IMAGE");
                    turbo.uploadFile(function(err, data){
                        if (err){
                            alert('Error:' + err.message)
                            return
                        }

                        if (data.confirmation != 'success'){
                            alert('Error: ' + data.message)
                            return
                        }

                        var updatedProfile = {
                            id: $('#profile-id').val(),
                            coverImage: data.result.url
                        }

                        commitUpdates(updatedProfile, function(profile){
                            $('#profile-cover-image').attr('src', profile.coverImage+'=s64-c')
                        })
                    })
                })

                $('#profile-update-button').click(function(event){
                    event.preventDefault()
                    var updatedProfile = {
                        firstName: $('#profile-first-name').val().trim(),
                        lastName: $('#profile-last-name').val().trim(),
                        username: $('#profile-username').val().trim(),
                        hourlyRate: $('#profile-hourly-rate').val().trim(),
                        state: $('#profile-state').val(),
                        city: $('#profile-city').val().trim(),
                        bio: $('#profile-bio').val().trim(),
                        id: $('#profile-id').val()
                    }

                    commitUpdates(updatedProfile, null)
                })

                $('#update-industries').click(function(event){
                    event.preventDefault()
                    var ind = [];
                    $('#industries input:checked').each(function() {
                        ind.push( $(this).val() )
                    })

                    // Note: JQuery formats POST params improperly, so they are
                    // stringified here, and then parsed in 'auth.js'
                    var updatedProfile = {
                        industries: JSON.stringify(ind),
                        id: $('#profile-id').val()
                    }

                    commitUpdates(updatedProfile, null)
                })
            })
        </script>
    </body>

</html>